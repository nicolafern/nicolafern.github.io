<!doctype html>
<!--[if lt IE 7 ]><html itemscope itemtype="http://schema.org/Article" id="ie6" class="ie ie-old" lang="en-US"><![endif]-->
<!--[if IE 7 ]>   <html itemscope itemtype="http://schema.org/Article" id="ie7" class="ie ie-old" lang="en-US"><![endif]-->
<!--[if IE 8 ]>   <html itemscope itemtype="http://schema.org/Article" id="ie8" class="ie ie-old" lang="en-US"><![endif]-->
<!--[if IE 9 ]>   <html itemscope itemtype="http://schema.org/Article" id="ie9" class="ie" lang="en-US"><![endif]-->
<!--[if gt IE 9]><!--><html itemscope itemtype="http://schema.org/Article" lang="en-US"><!--<![endif]-->
<head>

    <!-- Meta -->
    <meta charset="utf-8">
    
    <title>Macrology Nicola Fern - Learning Technologist</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <!-- RSS -->
    <link rel="alternate" type="application/rss+xml" title="Nicola Fern - Learning Technologist ♥ Portfolio, blog, thoughts and techniques" href="https://nicolafern.github.io/feed.xml">
    <link rel="alternate" type="application/atom+xml" title="Nicola Fern - Learning Technologist ♥ Portfolio, blog, thoughts and techniques" href="https://nicolafern.github.io/atom.xml">

    <!-- Favicons -->
    <link rel="shortcut icon" sizes="16x16 24x24 32x32 48x48 64x64 96x96" href="https://nicolafern.github.io/favicon.ico">
    <link rel="apple-touch-icon" sizes="57x57" href="https://nicolafern.github.io/img/favicons/favicon-57.png">
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://nicolafern.github.io/img/favicons/favicon-57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="https://nicolafern.github.io/img/favicons/favicon-60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="https://nicolafern.github.io/img/favicons/favicon-72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="https://nicolafern.github.io/img/favicons/favicon-76.png">
    <link rel="apple-touch-icon" sizes="96x96" href="https://nicolafern.github.io/img/favicons/favicon-96.png">
    <link rel="apple-touch-icon" sizes="114x114" href="https://nicolafern.github.io/img/favicons/favicon-114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="https://nicolafern.github.io/img/favicons/favicon-120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="https://nicolafern.github.io/img/favicons/favicon-144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="https://nicolafern.github.io/img/favicons/favicon-152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="https://nicolafern.github.io/img/favicons/favicon-180.png">
    <link rel="apple-touch-icon" sizes="192x192" href="https://nicolafern.github.io/img/favicons/favicon-192.png">
    <meta name="application-name" content="Nicola Fern - Learning Technologist ♥ Portfolio, blog, thoughts and techniques">
    <meta name="msapplication-TileImage" content="https://nicolafern.github.io/img/favicons/favicon-144.png">
    <meta name="msapplication-TileColor" content="#ffffff">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Cookie" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">

    <!-- Styles -->
    <link rel="stylesheet" href="https://nicolafern.github.io/css/style.css">
       <!-- Optional theme -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

    <!--[if lt IE 9]>
        <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://nicolafern.github.io/js/respond.min.js"></script>
    <![endif]-->

</head>
<body class="">

<div class="container-fluid pagehead">
    <div class="row">
        <div class="col-sm-6"><img class="logo" src="img/logo.png"></div>
        <div class="col-sm-6"><p class="logotext">Text goes here</p></div>
    </div>
</div>


    



    

<div class="title-group">
    <h1 class="special">
        <span>
        
            Macrology
        
        </span>
    </h1>
    
    <aside>
        01.14.16
        
            &middot;
            
                <span>programming</span>
            
        
    </aside>
    
    <p class="lead">
        
            I'm no programmer, as I've probably mentioned before...However, I have been learning and improving somewhat in that regard lately, and I'm never afraid to have a bash and conjure up some Frankencode, poking it, stitching bits together and generally waving a lightning rod at it until it does what I want.
        
    </p>
</div>

    <article>
        <div class="container">
            <div class="row">
                <div class="col-md-10 col-md-offset-1">


                    <p>I’m no programmer, as I’ve probably mentioned before…However, I have been learning and improving somewhat in that regard lately, and I’m never afraid to have a bash and conjure up some Frankencode, poking it, stitching bits together and generally waving a lightning rod at it until it does what I want.</p>

<p>My latest adventure was brought to me by a colleague who wanted to be able to generate a censored version of an Excel workbook for sharing with others, which removed some of the columns containing personal information, while preserving tab names and as much formatting as possible.</p>

<p>I looked online and couldn’t find something exact, so I set about piecing something together from different pages and help sites.  I thought I’d share my resultant code here in case anyone else found it useful…</p>

<p>It’s worth noting one issue that drove me a bit batty:</p>

<p>The Worksheets(1), Worksheets(2), Worksheets(3)…numbering in the code refer to each sheet in the source workbook numerically from the sheet beginning at the left hand page…so you have to count sheets from left to right to find out which number your sheet is.  This is confusing since it effectively means each sheet has three potential names or labels:  This strict number order, the (name) - defaults to a sheet number (i.e. depending on which order the sheets are created in), and lastly the visible label on the tab - often whatever name you give it.  These last two can be changed by the user.  The sheet highlighted in the grab below has been given a (name) of test, has a Name of Sheet1, and then on screen it’s the last tab (Sheet 42) - so the reference in the Macro code below for it would end up being Worksheets(42).  It can be <em>very</em> confusing. This workbook had those 42 tabs, and all the sheet references had to be worked out by counting on the screen - because the sheets had been created dynamically and moved around, the numbers they were assigned by the system didn’t correspond to their location.  As an example, I have a sheet labelled on the tab as Sheet 2, with a (name) of Sheet42, but in position 32 - so the reference would be Worksheets(32)!</p>

<p><img src="img/macrograb.png" /></p>

<p>Anyway, rant over - here’s the code - I hope it saves at lease one person some frustration!</p>

<p>Note: When pasting the code, if the comments (lines preceded by ‘) wrap across multiple lines, comment extra lines out with ‘ or delete them as VBA doesn’t like multi-line comments.</p>

<p><b>Macro for duplicating selected columns from selected Excel worksheets into a new workbook</b></p>

<pre class="pre-scrollable"><code>
'replace this with the name of your macro
Sub CopyData()

'defines your variable names as cell ranges
Dim sourceColumnSh1 As Range, sourceColumnSh2 As Range, sourceColumnSh3 As Range, sourceColumnSh4 As Range, sourceColumnSh5 As Range

'Tells excel how many sheets we want new workbooks to contain - replace 5 with any number
Application.SheetsInNewWorkbook = 5

'1st line creates the new workbook, and the subsequent lines declare names for each sheet
Set targetBook = Workbooks.Add
Sheets("Sheet1").Name = "AU"
Sheets("Sheet2").Name = "CCU"
Sheets("Sheet3").Name = "CTU"
Sheets("Sheet4").Name = "Comp Therapy"
Sheets("Sheet5").Name = "Endo"

'The following codeblock assigns a cell range from the original workbook to the variable.
'It also specifies the column destination in the new workbook (i.e. Col A means it will 
'be pasted into the workbook starting at the first column.This is probably what you want)
'Duplicate this block and the Destination line below for each sheet you want to copy
'Change the cell range to reflect the columns you want to extract
'To take the whole column, use "A:A" - but I found that this caused large file (on the order of 
'36MB) issues when there were hidden cells (i.e. if a filter was used on the original file) so I 
'recommend limiting the rows to a reasonable number. Change the '150' part to increase or 
'decrease the rows copied.

Set sourceColumnSh1 = Workbooks("YourSourceFileName.xlsm").Worksheets(1).Range("A1:A150,B1:B150,E1:E150,F1:F150,G1:G150,H1:H150,J1:J150,K1:K150,N1:N150")
'Worksheets(1) in the line above refers to the source worksheet reference.
Set targetBook = Worksheets(1).Columns("A")
'Worksheets(1) in the line above refers to the destination worksheet reference.

sourceColumnSh1.Copy Destination:=targetBook
'The line above copies the cells from the first workbook into the new one.

Set sourceColumnSh2 = Workbooks("YourSourceFilename.xlsm").Worksheets(2).Range("A1:A150,B1:B150,E1:E150,F1:F150,G1:G150,H1:H150,J1:J150,K1:K150,N1:N150")
Set targetBook = Worksheets(2).Columns("A")

sourceColumnSh2.Copy Destination:=targetBook

Set sourceColumnSh3 = Workbooks("YourSourceFilename.xlsm").Worksheets(3).Range("A1:A150,B1:B150,E1:E150,F1:F150,G1:G150,H1:H150,J1:J150,K1:K150,N1:N150")
Set targetBook = Worksheets(3).Columns("A")

sourceColumnSh3.Copy Destination:=targetBook

Set sourceColumnSh4 = Workbooks("YourSourceFilename.xlsm").Worksheets(4).Range("A1:A150,B1:B150,E1:E150,F1:F150,G1:G150,H1:H150,J1:J150,K1:K150,N1:N150")
Set targetBook = Worksheets(4).Columns("A")

sourceColumnSh4.Copy Destination:=targetBook

Set sourceColumnSh5 = Workbooks("YourSourceFilename.xlsm").Worksheets(5).Range("A1:A150,B1:B150,E1:E150,F1:F150,G1:G150,H1:H150,J1:J150,K1:K150,N1:N150")
Set targetBook = Worksheets(5).Columns("A")

sourceColumnSh5.Copy Destination:=targetBook

End Sub
</code></pre>

                </div>
            </div>
        </div>
    </article>


    <footer class="site-footer">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <p class="text-muted">This text is footer text. Footer text goes here.</p>
                </div>
            </div>
        </div>
    </footer>


    <!-- JavaScript -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <script src="https://nicolafern.github.io/js/power.js"></script>

    </body>
</html>